
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Books</h2>

@Styles.Render("~/Content/kedno")
@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/kendo")

@(Html.Kendo().Grid<Models.Books.BookViewModel>()
        .Name("grid")
        .Columns(columns =>
        {
            columns.Bound(c => c.Author);
            columns.Bound(c => c.Title);
            columns.Bound(c => c.ReleaseDate);
            columns.Bound(c => c.ISBN);
            columns.Bound(c => c.BookGenre);
            columns.Bound(c => c.Count);
            columns.Bound(c => c.AddDate);
            columns.Bound(c => c.ModifiedDate);
            columns.Bound(c => c.BookId).ClientTemplate((@Html.ActionLink("Edit", "EditBookIndex", "Books", new { aBookId = "#=BookId#" }, null).ToHtmlString()));
        })
        .ToolBar(toolbar => toolbar.Template("<button onclick='AddNewBookWindow()'>Add new book</button> "))
        .Scrollable()
        .Groupable()
        .Sortable()
        .Pageable(pageable => pageable
            .Refresh(true)
            .PageSizes(true)
            .ButtonCount(5))
        .DataSource(dataSource => dataSource
            .Ajax()
            .Read(read => read.Action("GetBooksList", "Books"))
            .PageSize(20)
            .Model(model => model.Id(a => a.BookId))
        )
)

@(Html.Kendo().Window()
              .Name("window")
              .Title("Add book")
              .LoadContentFrom("AddBookIndex", "Books")
              .Visible(false)
)

<script type="text/javascript">

    function AddNewBookWindow() {
        var win = $("#window").data("kendoWindow");
        win.center().open();
    }

    function ReloadGrid() {
        $('#grid').data('kendoGrid').dataSource.read();
        $('#grid').data('kendoGrid').refresh();
    }

    function editSucces(result) {
        alert(result.value);
    }

</script>